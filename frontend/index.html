<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Equity Analyst</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<header>
  <div class="header-inner">
    <span class="logo">Equity <span>Analyst</span></span>
    <form id="search-form">
      <input id="ticker-input" type="text" placeholder="e.g. AAPL"
             autocomplete="off" spellcheck="false" maxlength="10" />
      <button type="submit" id="analyze-btn">Analyze &#8594;</button>
    </form>
  </div>
</header>

<main>

  <!-- Empty state -->
  <div id="empty-state">
    <div class="hero-icon">&#128202;</div>
    <h2>AI-Powered Equity Analysis</h2>
    <p>Enter a ticker above to pull the latest 10-K filing and earnings transcript,
       calculate a DCF intrinsic value, and generate a structured bull/bear analysis.</p>
  </div>

  <!-- Loading -->
  <div id="loading" hidden>
    <div class="spinner"></div>
    <p>Fetching filings and running analysis&hellip;</p>
    <p class="sub">This may take 20&ndash;40 seconds.</p>
  </div>

  <!-- Error -->
  <div id="error-state" hidden>
    <strong>Analysis failed</strong>
    <p id="error-msg"></p>
  </div>

  <!-- Results -->
  <div id="results" hidden>

    <!-- Meta bar -->
    <div class="meta-bar" id="meta-bar"></div>

    <!-- Source document links -->
    <div class="source-docs" id="source-docs" hidden></div>

    <!-- Price comparison widget -->
    <div class="price-widget" id="price-widget"></div>

    <!-- Tab bar -->
    <div class="tab-bar">
      <button class="tab-btn active" data-tab="analysis">Analysis</button>
      <button class="tab-btn" data-tab="financials">Financials</button>
      <button class="tab-btn" data-tab="industry">Industry</button>
      <button class="tab-btn" data-tab="dcf">DCF Model</button>
      <button class="tab-btn" data-tab="ddm">DDM</button>
      <button class="tab-btn" data-tab="comps">Comps</button>
    </div>

    <!-- ── Analysis tab ── -->
    <div id="tab-analysis">
      <div id="rating-thesis" hidden></div>
      <div id="key-metrics-strip" hidden></div>

      <div class="two-col">
        <div class="card bull">
          <div class="card-header">
            <div class="card-icon">&#9650;</div>
            <span class="card-title">Bull Case</span>
          </div>
          <ol id="bull-list"></ol>
        </div>
        <div class="card bear">
          <div class="card-header">
            <div class="card-icon">&#9660;</div>
            <span class="card-title">Bear Case</span>
          </div>
          <ol id="bear-list"></ol>
        </div>
      </div>

      <div class="card risks">
        <div class="card-header">
          <div class="card-icon">&#9888;</div>
          <span class="card-title">Downplayed Risks</span>
        </div>
        <ol id="risks-list"></ol>
      </div>

      <div id="catalysts-section" hidden>
        <div class="two-col">
          <div class="card catalysts">
            <div class="card-header">
              <div class="card-icon">&#9889;</div>
              <span class="card-title">Recent Catalysts</span>
            </div>
            <ol id="catalysts-list"></ol>
          </div>
          <div class="card sentiment">
            <div class="card-header">
              <div class="card-icon">&#128172;</div>
              <span class="card-title">Market Sentiment</span>
            </div>
            <p id="sentiment-text"></p>
          </div>
        </div>
      </div>

      <div class="card summary">
        <div class="card-header">
          <span class="card-title">Analyst Summary</span>
        </div>
        <p id="summary-text"></p>
      </div>
    </div><!-- /tab-analysis -->

    <!-- ── Financials tab ── -->
    <div id="tab-financials" hidden>

      <div id="fin-unavailable" class="dcf-unavailable" hidden>
        <p>Financial data unavailable</p>
        <p>Could not retrieve financial statements for this ticker.</p>
      </div>

      <div id="fin-content">
        <div class="fin-header">
          <div>
            <div class="dcf-proj-title">Financial Statements</div>
            <div class="dcf-proj-subtitle">Historical annual data from SEC filings</div>
          </div>
          <div class="fin-sub-tabs" id="fin-sub-tabs">
            <button class="fin-sub-btn active" data-stmt="income">Income Statement</button>
            <button class="fin-sub-btn" data-stmt="balance">Balance Sheet</button>
            <button class="fin-sub-btn" data-stmt="cashflow">Cash Flow</button>
            <button class="fin-sub-btn" data-stmt="ratios">Key Ratios</button>
          </div>
        </div>

        <div id="fin-statement-body"></div>
      </div>

    </div><!-- /tab-financials -->

    <!-- ── Industry tab ── -->
    <div id="tab-industry" hidden>

      <div id="industry-unavailable" class="industry-unavailable" hidden>
        <p>Industry analysis unavailable for this ticker.</p>
      </div>

      <div id="industry-content">
        <!-- Porter's Five Forces -->
        <p class="dcf-section-label">Porter&#8217;s Five Forces</p>
        <div class="porter-grid" id="porter-grid"></div>

        <!-- Industry Structure -->
        <div class="card industry-prose" style="margin-bottom:16px">
          <div class="card-header">
            <span class="card-title industry-title">Industry Structure</span>
          </div>
          <div id="industry-structure"></div>
        </div>

        <!-- Competitive Position -->
        <div class="card industry-prose" style="margin-bottom:16px">
          <div class="card-header">
            <span class="card-title industry-title">Competitive Position</span>
          </div>
          <p id="competitive-position"></p>
        </div>

        <!-- Key Industry KPIs -->
        <div class="card" style="margin-bottom:16px">
          <div class="card-header">
            <span class="card-title industry-title">Key Industry KPIs</span>
          </div>
          <ul class="kpi-list" id="kpi-list"></ul>
        </div>

        <!-- Tailwinds & Headwinds -->
        <div class="two-col">
          <div class="card bull">
            <div class="card-header">
              <div class="card-icon">&#9650;</div>
              <span class="card-title">Industry Tailwinds</span>
            </div>
            <ol id="tailwinds-list"></ol>
          </div>
          <div class="card bear">
            <div class="card-header">
              <div class="card-icon">&#9660;</div>
              <span class="card-title">Industry Headwinds</span>
            </div>
            <ol id="headwinds-list"></ol>
          </div>
        </div>
      </div>

    </div><!-- /tab-industry -->

    <!-- ── DCF Model tab ── -->
    <div id="tab-dcf" hidden>

      <div id="dcf-unavailable" class="dcf-unavailable" hidden>
        <p>DCF data unavailable</p>
        <p>Financial statement data could not be retrieved for this ticker.<br>
           The analysis above is based on SEC filings and earnings transcripts only.</p>
      </div>

      <div id="dcf-content">
        <div id="dcf-warning" class="dcf-warning" hidden></div>

        <!-- Projection table (injected by dcf.js) -->
        <div id="dcf-projection"></div>

        <p class="dcf-section-label">Cost of Capital</p>
        <div class="wacc-grid" id="dcf-wacc"></div>

        <p class="dcf-section-label">Valuation Bridge</p>
        <div class="bridge-card" id="dcf-bridge"></div>
      </div>

    </div><!-- /tab-dcf -->

    <!-- ── DDM tab ── -->
    <div id="tab-ddm" hidden>

      <div id="ddm-unavailable" class="dcf-unavailable" hidden>
        <p>DDM not applicable</p>
        <p>This company does not pay dividends, so the Dividend Discount Model<br>
           cannot be used to estimate intrinsic value.</p>
      </div>

      <div id="ddm-content">
        <!-- Dividend history table -->
        <div class="dcf-proj-header">
          <div>
            <div class="dcf-proj-title">Dividend Discount Model</div>
            <div class="dcf-proj-subtitle">Click highlighted values to override assumptions</div>
          </div>
          <div class="proj-buttons">
            <button class="btn-reset" id="ddm-reset-btn">Reset</button>
            <button class="btn-recalc" id="ddm-recalc-btn">Recalculate</button>
          </div>
        </div>

        <p class="dcf-section-label">Dividend History</p>
        <div id="ddm-history"></div>

        <p class="dcf-section-label">Key Metrics</p>
        <div class="wacc-grid" id="ddm-assumptions"></div>

        <!-- GGM and Two-Stage side by side -->
        <div class="ddm-models-grid">
          <div id="ddm-ggm"></div>
          <div id="ddm-twostage"></div>
        </div>
      </div>

    </div><!-- /tab-ddm -->

    <!-- ── Comps tab ── -->
    <div id="tab-comps" hidden>

      <div id="comps-unavailable" class="dcf-unavailable" hidden>
        <p>Peer comparison unavailable</p>
        <p>Could not retrieve comparable company data for this ticker.</p>
      </div>

      <div id="comps-content">
        <div class="fin-header">
          <div>
            <div class="dcf-proj-title">Comparable Company Analysis</div>
            <div class="dcf-proj-subtitle">Relative valuation vs. sector peers (TTM multiples)</div>
          </div>
          <div class="fin-sub-tabs" id="comp-sub-tabs">
            <button class="fin-sub-btn active" data-view="valuation">Valuation</button>
            <button class="fin-sub-btn" data-view="profitability">Profitability</button>
            <button class="fin-sub-btn" data-view="growth">Growth &amp; Risk</button>
          </div>
        </div>

        <div class="comp-implied-grid" id="comp-implied"></div>

        <div id="comp-table-body"></div>
      </div>

    </div><!-- /tab-comps -->

  </div><!-- /results -->

</main>

<script src="js/api.js?v=3"></script>
<script src="js/analysis.js?v=3"></script>
<script src="js/financials.js?v=3"></script>
<script src="js/industry.js?v=3"></script>
<script src="js/dcf.js?v=3"></script>
<script src="js/ddm.js?v=3"></script>
<script src="js/comps.js?v=3"></script>
<script src="js/app.js?v=3"></script>
</body>
</html>
